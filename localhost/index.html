<html>
<head>
    <title>magic</title>
</head>
<body>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script type="text/javascript">
        window.addEventListener('message', async function(event) {
            const allowedOrigins = [
                'https://debridmediamanager.com',
                'https://beta.debridmediamanager.com',
                'http://localhost:3000',
            ];
            if (!allowedOrigins.includes(event.origin)) {
                console.warn('Origin not allowed:', event.origin);
                return;
            }

            const requestData = event.data;

            const { messageId, url, method, headers, body } = requestData;
            try {
                const response = await axios({ url, method, headers, data: body });
                const responseData = { messageId, response: response.data };
                window.parent.postMessage(responseData, event.origin);
            } catch (error) {
                const errorData = { messageId, error: error.toString() };
                console.error('Error:', errorData);
                window.parent.postMessage(errorData, event.origin);
            }
        }, false);
    </script>
</body>
</html>